---
title: "Do real-world developments predict far-right news on immigration?"
subtitle: "ECPR General Conference"
author: "Christian S. Czymara (Twitter: *@cczymara*)"
date: "24 August 2022"
format:
  revealjs:
    incremental: true # html: revealjs; pdf: beamer; powerpoint: pptx
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, # no R code
                      message = FALSE, # no warning messages
                      comment = NA, # no hashtags in output
                      results = "asis" # results directly in text
                      )

packages <- c("dplyr", "tidyr", "knitr", "purrr",
              "stm", "quanteda", "tidytext",
              "sjPlot")
lapply(packages, library, character.only = TRUE)

load("C:/Users/czymara.local/PowerFolders/going/JF_islam/analysis/in/JF_migration_results.RData")

library(ggplot2); theme_set(theme_bw() +
                              theme(axis.line = element_line(colour = "black"),
                                    panel.grid.major = element_blank(),
                                    panel.grid.minor = element_blank(),
                                    panel.border = element_blank(),
                                    panel.background = element_blank(),
                                    axis.text = element_text(color="black"),
                                    axis.ticks = element_line(colour = "black")))
```

```{css}
h1.title {
  font-size: 60px
}
```

## Research questions

-   Anti-immigration positions are a core element of the political right
-   Goal: Test relationship between right-wing immigration news and real-world developments based on...
(i) overall issue salience
(ii) discursive shifts within the immigration issue

## Right-wing media

-   Prior research suggests limited influence of real-world indicators on mainstream media (Jacobs et al. 2018)
-   Right-wing parties and actors increasingly politicize immigration (Grande, Schwarzbözl, and Fatke 2019; Hutter and Kriesi 2021)
-   Right-wing media is a most-likely case to politicize/problematize real-world developments

## Expectations on issue salience

-   Rising *immigration rates* are associated with more articles on immigration
-   Rising *foreigner crime rates* are associated with more articles on immigration
-   *Islamist attacks* are associated with more articles on immigration
-   ... particularly attacks in Germany

## Expectations on discursive shifts

-   Rising *immigration rates* increase *threat-related topics* within immigration news
-   Rising *foreigner crime rates* increase the *crime topic* within immigration news
-    *Islamist attacks* increase the *terrorism topic* within immigration news
-   ... particularly attacks in Germany

## The Case: Junge Freiheit

-   Weekly newspaper founded in 1986, largest right-wing print outlet in Germany
-   Between conservative and far-right, often bridging democratic conservatism and the extreme right
-   "one of the sharpest weapons in the arsenal of the New Right" (Braun, Geisler, and Gerster 2007: 17)
-   Fifth largest weekly newspaper in Germany, circulation of over 30,000 sold copies each quarter (IVW 2021)

## Circulation

```{r}
load("C:/Users/czymara.local/PowerFolders/going/JF_islam/analysis/in/auflage.RData")

auflage %>%
  filter(quart < "2020 Q1") %>%
  ggplot(aes(x = quart,
             y = Verbreitung)) +
  xlab("Quarter") +
  ylab("Circulation") +
  geom_point() +
  geom_line()
```
Source: Informationsgemeinschaft zur Feststellung der Verbreitung von Werbeträgern (2021)

## Identifying articles about immigration

-   Scraped web archive of Junge Freiheit ($N=53,818$ after cleaning)
-   Regular expressions using keywords
-   Trained Naïve Bayes classifier based on hand-coded random sample of 600 articles (recall: 0.97, precision: 0.78)
-   $n=5,695$ positive predictions in overall data

## Development of articles on immigration

```{r, results = "markup"}
data_mig %>%
  group_by(date2) %>%
  mutate(ncomments = n()) %>%
  ggplot(aes(x = date2,
             y = ncomments)) +
  geom_point() +
  geom_smooth(level = 0.9999) +
  xlab("Date") +
  ylab("Number of weekly articles") +
  theme_bw() +
  theme(legend.title=element_blank())
```

## Real-world indicators

-   Number of immigrants to Germany with non-EU citizenship (Eurostat)
-   Islamist attacks w/ at least one casualty or injury in Western countries / in Germany (Fondapol 2021) in 2 weeks before article publication
-   Share of reported crimes conducted by non-German suspects (BKA 2021)

## Effect of real-world indicators on issue salience

```{r, include = FALSE}
m_immigration <- glm(mig ~ immigration, data = data_reg, family = "binomial")
m_auslkrimproz <- glm(mig ~ auslkrimproz, data = data_reg, family = "binomial")
m_week_following_event <- glm(mig ~ week_following_event, data = data_reg, family = "binomial")
m_week_following_event_de <- glm(mig ~ week_following_event_de, data = data_reg, family = "binomial")
```

::: {style="text-align: center; font-size: 18px;"}
```{r, results = "markup"}
tab_model(m_immigration,
          m_auslkrimproz,
          m_week_following_event,
          m_week_following_event_de,
          show.std = TRUE,
          show.est = FALSE,
          collapse.ci = TRUE,
          show.p = TRUE,
          pred.labels = c("Intercept", "Immigration rate",
                          "Foreigner crime rate",
                          "Terror attack", "Terror attack (DE)"),
          dv.labels = c("Immigration", "Crime", "Terror", "Terror (DE)")
          )
```
:::

## Modelling discoursive shifts

-   Decompose immigration issue into its thematic subcomponents using Structural Topic Models (STM)
-   STM identify word clusters (topics) in texts without restrictions (except for number of topics, here: 30)
-   All topics consist of all terms, and all articles of all topics, but both with varying probability
-   Modelling a shift in right-wing discursive priorities

::: {style="font-size: 30px;"}
## Two examples

(i)   Immigration policy topic
-   Terms: *mass immigration, uncontrolled*
-   Example: *From dilemma to disaster: Europe and Germany are not deporting too much, but too little* (Paulwitz in Junge Freiheit 43/13)
(ii) Asylum topic
-   Terms: *deportation, authorities*
-   Example: *The difficult path to a "culture of goodbye": Under pressure from the continuing influx of asylum seekers, the low number of deportations comes under criticism* (Persdorf in Junge Freiheit 41/15)
:::

## Effect of immigration on selected topics

```{r, include = FALSE}
topicNames <- c("National identity", # 1
                "Antifa", # 2
                "Immigration policy", # 3
                "Education", # 4
                "Media", # 5
                "Countries 1", # 6
                "CDU/CSU", # 7
                "AfD", # 8
                "Turkey", # 9
                "Austria", # 10
                "Integration/\ncitizenship", # 11
                "Elections", # 12
                "Terrorism", # 13
                "EU politics", # 14
                "Asylum", # 15
                "Countries 2", # 16 (culture war)
                "Countries 3", # 17
                "Balkan", # 18
                "Religion", # 19
                "International immigration", # 20
                "Reports", # 21
                "Ethnic violence", # 22
                "Right-wing protest", # 23
                "Illegal\nimmigration", # 24
                "Economy", # 25"
                "Demography", # 26
                "Countries 4", # 27
                "Syria war", # 28
                "Crime", # 29
                "Welfare state" # 30
                )
immiTopics <- c(3, # German immigration policy
                11, # Integration/citizenship
                15, # Asylum
                20, # EU immigration policy
                24, # Illegal immigration
                26 # Demography
                )
secuTopics <- c(13, # Terrorism
                29, # Crime
                22 # Ethnic violence
                )
culTopics <- c(1, # National identity
               19 # Islam
               )
econTopics <- c(25, # Economy
                30 # Welfare state
                )
relevantTopics <- c(1, 3, 11, 13, 15, 19, 20, 22, 24, 25, 26, 29, 30)


plot_immigration <- plot(effect_immigration,
                         covariate = "immigration",
                         method = "continuous",
                         topics = c(immiTopics, secuTopics, culTopics, econTopics),
                         model = topics_mig_JF,
                         xaxt = "n")
plot_immigration_df <- data.frame(matrix(unlist(plot_immigration$means),
                                         nrow = length(plot_immigration$means),
                                         byrow = TRUE))
colnames(plot_immigration_df) <- plot_immigration$x
plot_immigration_df$topics <- topicNames[c(immiTopics, secuTopics, culTopics, econTopics)]
plot_immigration_df2 <- pivot_longer(plot_immigration_df, -topics,
                                     values_to = "mean",
                                     names_to = "X")
# lower bounds
lower <- data.frame(matrix(unlist(plot_immigration$ci)[seq(1, length(unlist(plot_immigration$ci)), 2)], # lower bounds
                                  nrow = length(plot_immigration$ci),
                                  byrow = TRUE))
colnames(lower) <- plot_immigration$x
lower$topics <- topicNames[c(immiTopics, secuTopics, culTopics, econTopics)]
lower <- pivot_longer(lower, -topics,
                      values_to = "lowerCI",
                      names_to = "X")
# upper bounds
upper <- data.frame(matrix(unlist(plot_immigration$ci)[seq(2, length(unlist(plot_immigration$ci)), 2)], # upper bounds
                           nrow = length(plot_immigration$ci),
                           byrow = TRUE))
colnames(upper) <- plot_immigration$x
upper$topics <- topicNames[c(immiTopics, secuTopics, culTopics, econTopics)]
upper <- pivot_longer(upper, -topics,
                      values_to = "upperCI",
                      names_to = "X")
# combine
plot_immigration_df2$lowerCI <- lower$lowerCI
plot_immigration_df2$upperCI <- upper$upperCI
plot_immigration_df2$X <- as.numeric(plot_immigration_df2$X)
```

```{r}
plot_immigration_df2 %>%
  ggplot(aes(x = X, y = mean, group = topics)) +
  geom_line() +
  facet_wrap(vars(topics), ncol = 5) +
  geom_ribbon(aes(ymin = lowerCI, ymax = upperCI), alpha = 0.1) +
  theme(legend.position = "none",
        axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
  scale_x_continuous(breaks = c(min(plot_immigration_df2$X),
                                max(plot_immigration_df2$X)),
                     label = c("Min", "Max")) +
  labs(x = "Immigration numbers", y = "Topic probability")
```

## Effects of terrorism and crime

```{r, include = FALSE}
effect_crime <- estimateEffect(c(28) ~ crime,
                               topics_mig_JF,
                               metadata = JF_mig_DFM_final@docvars)
effect_crime_table <- round(data.frame(summary(effect_crime)$tables), 3)

effect_terror <- estimateEffect(c(13) ~ terrorWeeks, topics_mig_JF,
                                 metadata = JF_mig_DFM_final@docvars)
effect_terror_table <- round(data.frame(summary(effect_terror)$tables), 3)

effect_terror_de <- estimateEffect(c(13) ~ terrorWeeks_de, topics_mig_JF,
                                metadata = JF_mig_DFM_final@docvars)

effect_terror_de_table <- round(data.frame(summary(effect_terror_de)$tables), 3)

reg_table <- rbind(effect_terror_table[2,], effect_terror_de_table[2,], effect_crime_table[2,])

colnames(reg_table) <- c("Estimate", "Std. Error", "t value", "Pr(>|t|)")
rownames(reg_table) <- c("Terror attacks", "Terror attacks (DE only)", "Foreigner crime rates")
```

```{r, results = "markup"}
reg_table
```
-   In the aftermath of Islamist terror attacks, terrorism is more prevalent
-   ... which is over six times stronger for attacks in Germany
-   Foreigner crime is not associated with an increase of the crime topic

## Conclusion

-   Reporting on immigration increased over time, peaking 2015/16
-   Real-world developments predict issue salience of immigration
-   JF responded to rising immigration rates with topics related to cultural, economic, and security threat (deportation, closing borders, criminalization), humanitarian topics practically absent
-   Terror attacks (esp. in Germany) shaped reporting; crime rates were not systematically addressed


# Appendix

## All topics, part 1

```{r, results = "markup"}
topics_table <- summary(topics_mig_JF)
topics_table <- t(topics_table$prob)
colnames(topics_table) <- topicNames

topics_table[1:5,][ ,relevantTopics][,1:7]
```

## All topics, part 2

```{r, results = "markup"}
topics_table[1:5,][ ,relevantTopics][,8:ncol(topics_table[1:5,][ ,relevantTopics])]
```

## Topic prevalence

```{r}

beta <- tidy(topics_mig_JF)
gamma <- tidy(topics_mig_JF, matrix = "gamma",
              document_names = rownames(JF_mig_DFM_final))
topterms_pertopic <- beta %>%
  arrange(beta) %>%
  group_by(topic) %>%
  top_n(3, beta) %>%
  arrange(-beta) %>%
  select(topic, term) %>%
  summarise(terms = list(term)) %>%
  mutate(terms = map(terms, paste, collapse = "\n ")) %>%
  unnest(cols = c(terms))
gamma_terms <- gamma %>%
  group_by(topic) %>%
  summarise(gamma = mean(gamma)) %>%
  mutate(topic = topicNames,
         topic = reorder(topic, gamma)
  )
gamma_terms[relevantTopics,] %>%
  ggplot(aes(y = topic,
             x = gamma)) +
  geom_col(show.legend = F) +
  geom_vline(xintercept=1/Ntopic) +
  labs(y = NULL,
       x = "Average Topic Probability")
```


